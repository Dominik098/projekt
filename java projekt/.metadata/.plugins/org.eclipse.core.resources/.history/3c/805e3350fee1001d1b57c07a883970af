<%@ page language="java" contentType="text/html; charset=UTF-8"%>


<%@ page import="java.sql.*" %>


 <!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="C_kategorie.css" type="text/css">

    <link rel="icon" type="image/png" href="3.png" sizes="96x96" />
    <title>Kategorie książek </title>

    
    
</head>

<body>
    <tr>
        <td align="center"><img src="logo.jpg" name="ksiazka" align="left" weight="90px" height="50px"></td>
    </tr>
    <h1>
        <center><u>Kategorie książek</u></center>
    </h1>
    <header>
        <nav>
            <ul>
                <li><a href="A_strona-gl.jsp">Strona główna</a></li>
                <li><a href="B_O bibiotece.jsp">O bibliotece</a></li>
                <li><a href="C_Kategorie książek.jsp">Kategorie książek </a></li>
                <li><a href="D_Wypożyczenia.jsp">Wypożyczane </a></li>
                <li><a href="E_Słownik pojęć.jsp">Słownik pojęć bibliotecznych</a></li>
                <li><a href="F_personel.jsp">Prersonel</a></li>
               <!-- <li><a href="G_login.jsp">Logowanie</a></li>
                <li><a href="H_rejestracja.jsp">Rejestracja</a></li>-->
                <li><a href= "logout">Wyloguj się</a></li>
                <li><a > <%=session.getAttribute("email-login") %> </a></li>
            </ul>

        </nav>

    </header>
    <h1>Księżki </h1>
    
    <h3>Oto lista wszystkich książek dostępnych do wypożyczenia w bibliotece </h3>
    
<table>
    <tr>
        <th>Lp.</th>
        <th>Tytuł</th>
        <th>Autor</th>
        <th>Wydawnictwo</th>
        <th>Data_publikacj</th>
        <th>PDF</th>
    </tr>
    <% 
        try {
            // Połączenie z bazą danych
            String url = "jdbc:mysql://localhost:3306/jak";
            String user = "root";
            String password = "P@ssw0rd";
            Connection conn = DriverManager.getConnection(url, user, password);

            // Zapytanie SQL
            String sql = "SELECT * FROM Książki";
            PreparedStatement ps = conn.prepareStatement(sql);
            ResultSet rs = ps.executeQuery();

            // Wyświetlenie wyników zapytania
            int i=0;
            while (rs.next()) { i++;
                String tytuł = rs.getString("tytuł");
                String autor = rs.getString("autor");
                String wydawnictwo = rs.getString("wydawnictwo");
                String data_publikacji = rs.getString("data_publikacji");
                
                String pdf_link = rs.getString("pdf_link");
    %>
        <tr>
            <td><%= i %></td>
            <td><%= tytuł %></td>
            <td><%= autor %></td>
            <td><%= wydawnictwo %></td>
            <td><%= data_publikacji %></td>
            <td>
                <% if (pdf_link != null && !pdf_link.isEmpty()) { %>
                <button onclick="pobierzPDF('<%= pdf_link %>')">Pobierz plik PDF</button>
                <% } else { %>
                Brak pliku PDF
                <% } %>
            </td>
        </tr>
    <% 
            }
            // Zamykanie połączenia z bazą danych
            rs.close();
            ps.close();
            conn.close();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    %>
</table>

<script>
    // Funkcja pobierająca plik PDF
    function pobierzPDF(link) {
        window.location.href = link;
    }
</script>
    

    <footer>
        <p>(c) 2023 Biblioteka Naukowa. Wszelkie prawa zastrzeżone.</p>
        <p>Adres: ul. Biblioteczna 1, 00-217 Warszawa Telefon: +48 123 456 789  E-mail: kontakt@bibliotekamiejska.pl.</p>

    </footer>



</body>

</html>